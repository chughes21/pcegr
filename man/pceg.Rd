% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pceg_function.R
\name{pceg}
\alias{pceg}
\title{The PCEG function}
\usage{
pceg(
  data,
  equivsize = 2,
  poisson_response = TRUE,
  variable_time = TRUE,
  zip = FALSE,
  remove_risk_free = FALSE,
  gamma_alpha = 1,
  gamma_beta = 2,
  prior_input = NULL,
  structural_zero = FALSE,
  indep = NA,
  saturated = NA,
  mean_post_cluster = FALSE,
  var_disc = 0,
  disc_length = 0,
  restrict = FALSE,
  mirror = FALSE,
  cat_limit = 0,
  collapse = FALSE
)
}
\arguments{
\item{data}{A data set where the observed response vector and time vector (if applicable and variable) are the last two columns.}

\item{equivsize}{A numeric value specifying the equivalent sample size for the prior, a measure of confidence in the prior.}

\item{poisson_response}{A logical value indicating whether the response variable is Poisson (TRUE) or categorical (FALSE).}

\item{variable_time}{A logical value indicating whether the observed time is uniform (FALSE) or variable (TRUE), if applicable.}

\item{zip}{A logical value indicating whether the model specified is zero-inflated (TRUE) or not (FALSE).}

\item{remove_risk_free}{A logical value indicating whether the risk free leaves and edges should be removed (TRUE) or not (FALSE).}

\item{gamma_alpha}{A numeric vector for the shape hyperparameters of the Gamma priors for the Poisson rates, if applicable. If a single value, each prior takes the same value.}

\item{gamma_beta}{A numeric vector for the rate hyperparameters of the Gamma priors for the Poisson rates, if applicable. If a single value, each prior takes the same value.}

\item{prior_input}{A list where each element is a matrix corresponding to a Dirichlet prior distribution for each level of the tree. If NULL, the default prior is used.}

\item{structural_zero}{A logical value indicating whether zero counts in the data set should be considered as structural (TRUE) or sampling (FALSE) for the setting of the prior.}

\item{indep}{An integer vector indicating which variables should be assumed to be independent of preceding variables (all situations in same stage).}

\item{saturated}{An integer vector indicating which variables should be assumed to be saturated (all situations in own stage).}

\item{mean_post_cluster}{A logical value indicating whether mean posterior clustering should be used (TRUE) or not (FALSE).}

\item{var_disc}{An integer value specifying which variable to discretise. If 0, no discretisation is necessary.}

\item{disc_length}{An integer value specifying how many neighbours can be searched over for the purposes of variable discetisation. If 0, all other possible stages may be merged over.}

\item{restrict}{A logical value indicating whether variable discretisation should be restricted to stages with the same unfolding of the process (TRUE) or not (FALSE).}

\item{mirror}{A logical value indicating whether variable discretisation should be equivalent across each unfolding of the process (TRUE) or not (FALSE).}

\item{cat_limit}{An integer value specifying the minimum number of categories to the variable can be discretised to. If 0, there is no minimum number of categories.}

\item{collapse}{A logical value indicating whether, when a restricted discretisation occurs, the final output should be compact (TRUE) or not (FALSE).}
}
\value{
An object of the S3 class StagedTree.
}
\description{
This function fits a PCEG model to a data set.
}
\details{
This function takes a data set, a prior structure, and various other inputs to fit a PCEG model. It is flexible enough to fit a vanilla CEG, and perform variable discretisation methods.
}
\examples{
mod<-pceg(knee_pain_obs,2,TRUE,TRUE)
plot(mod)
summary(mod)
}
